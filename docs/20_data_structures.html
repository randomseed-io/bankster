<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>Data Structures</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script><link rel="stylesheet" type="text/css" href="css/randomseed.css" /></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Bankster</span> <span class="project-version">2.2.4</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="10_introduction.html"><div class="inner"><span>Introduction</span></div></a></li><li class="depth-1 "><a href="11_sneak-peeks.html"><div class="inner"><span>Sneak peeks</span></div></a></li><li class="depth-1 "><a href="12_api.html"><div class="inner"><span>Bankster Front API</span></div></a></li><li class="depth-1 "><a href="15_contracts.html"><div class="inner"><span>Bankster Contracts</span></div></a></li><li class="depth-1  current"><a href="20_data_structures.html"><div class="inner"><span>Data Structures</span></div></a></li><li class="depth-1 "><a href="30_currency-kinds.html"><div class="inner"><span>Currency kinds</span></div></a></li><li class="depth-1 "><a href="32_currency_traits.html"><div class="inner"><span>Currency traits</span></div></a></li><li class="depth-1 "><a href="50_example_config.html"><div class="inner"><span>Example EDN config</span></div></a></li><li class="depth-1 "><a href="50_serialization.html"><div class="inner"><span>Serialization</span></div></a></li><li class="depth-1 "><a href="80_Apache-2-License.html"><div class="inner"><span>Apache License, v2.0</span></div></a></li><li class="depth-1 "><a href="85_LGPL-3-License.html"><div class="inner"><span>LGPL License, v3 or later</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>io</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>randomseed</span></div></div></li><li class="depth-3"><a href="io.randomseed.bankster.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bankster</span></div></a></li><li class="depth-4"><a href="io.randomseed.bankster.api.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>api</span></div></a></li><li class="depth-5 branch"><a href="io.randomseed.bankster.api.currency.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>currency</span></div></a></li><li class="depth-5 branch"><a href="io.randomseed.bankster.api.money.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>money</span></div></a></li><li class="depth-5 branch"><a href="io.randomseed.bankster.api.ops.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ops</span></div></a></li><li class="depth-5 branch"><a href="io.randomseed.bankster.api.registry.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-5"><a href="io.randomseed.bankster.api.v2.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>v2</span></div></a></li><li class="depth-6 branch"><a href="io.randomseed.bankster.api.v2.currency.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>currency</span></div></a></li><li class="depth-6 branch"><a href="io.randomseed.bankster.api.v2.money.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>money</span></div></a></li><li class="depth-6 branch"><a href="io.randomseed.bankster.api.v2.ops.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ops</span></div></a></li><li class="depth-6"><a href="io.randomseed.bankster.api.v2.registry.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-4 branch"><a href="io.randomseed.bankster.config.html"><div class="inner"><span class="tree" style="top: -300px;"><span class="top" style="height: 309px;"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-4 branch"><a href="io.randomseed.bankster.currency.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>currency</span></div></a></li><li class="depth-4 branch"><a href="io.randomseed.bankster.init.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>init</span></div></a></li><li class="depth-4 branch"><a href="io.randomseed.bankster.jsr-354.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>jsr-354</span></div></a></li><li class="depth-4"><a href="io.randomseed.bankster.money.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>money</span></div></a></li><li class="depth-5 branch"><a href="io.randomseed.bankster.money.inter-ops.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>inter-ops</span></div></a></li><li class="depth-5"><a href="io.randomseed.bankster.money.ops.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ops</span></div></a></li><li class="depth-4 branch"><a href="io.randomseed.bankster.registry.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-4 branch"><a href="io.randomseed.bankster.scale.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>scale</span></div></a></li><li class="depth-4"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>serializers</span></div></div></li><li class="depth-5 branch"><a href="io.randomseed.bankster.serializers.common.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>common</span></div></a></li><li class="depth-5 branch"><a href="io.randomseed.bankster.serializers.edn.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>edn</span></div></a></li><li class="depth-5"><a href="io.randomseed.bankster.serializers.json.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>json</span></div></a></li><li class="depth-4"><a href="io.randomseed.bankster.util.html"><div class="inner"><span class="tree" style="top: -114px;"><span class="top" style="height: 123px;"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-5 branch"><a href="io.randomseed.bankster.util.fs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fs</span></div></a></li><li class="depth-5 branch"><a href="io.randomseed.bankster.util.importer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>importer</span></div></a></li><li class="depth-5 branch"><a href="io.randomseed.bankster.util.map.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>map</span></div></a></li><li class="depth-5"><a href="io.randomseed.bankster.util.qe.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>qe</span></div></a></li></ul></div><div class="document" id="content"><div class="doc"><div class="markdown"><h1><a href="#data-structures" id="data-structures"></a>Data Structures</h1>
<h2><a href="#currency" id="currency"></a>Currency</h2>
<p>Currency is a record describing currency and having the following fields:</p>
<ul>
<li><code>id</code> – a keyword identifying a currency unit (e.g. <code>:EUR</code> or <code>:crypto/ETH</code>);</li>
<li><code>numeric</code> – a long value being a numeric identifier of ISO-standardized currencies (e.g. <code>978</code> or <code>-1</code> for none);</li>
<li><code>scale</code> – an integer of supported scale (decimal places, e.g. <code>2</code> or <code>-1</code> for auto);</li>
<li><code>kind</code> – a case-sensitive keyword with currency kind (may be namespaced, e.g. <code>:iso/fiat</code> or <code>:virtual/native</code>);</li>
<li><code>domain</code> – a keyword with currency domain (e.g. <code>:ISO-4217</code>, <code>:ISO-4217-LEGACY</code> or <code>:CRYPTO</code>).</li>
</ul>
<p>Additionally, currency may carry a non-inherent attribute <code>weight</code> (an integer value used when there are conflicting currency codes or numeric IDs during lookup; defaults to <code>0</code>).</p>
<p>The source of truth for weights is the registry base map <code>cur-id-&gt;weight</code> (and the top-level <code>:weights</code> branch in EDN configs/exports). Currency instances stored in registries also carry the weight in metadata as an optimization (hot-path: weighted buckets), but weight does not participate in <code>= / hash</code> semantics. Use <code>currency/weight</code> to read it.</p>
<p>Internally <code>numeric</code> can be <code>-1</code>, meaning there is no numeric ID and <code>scale</code> can be <code>-1</code> too, meaning the amount of currency can have any number of decimal places.</p>
<p>The currency domain is derived from an identifier if the identifier is namespaced (namespace is upper-cased). The derived code (name part) is upper-cased. Namespace <code>ISO-4217</code> is treated specially: it is stripped (case-insensitive) and implies <code>:domain :ISO-4217</code>. If there is no namespace the domain can be set to any keyword, with <code>:ISO-4217</code> having special meaning in some operations as it marks official currencies.</p>
<p>See also <code>doc/30_currency-kinds.md</code> (kind hierarchy) and <code>doc/32_currency_traits.md</code> (traits hierarchy).</p>
<h2><a href="#registry" id="registry"></a>Registry</h2>
<p>Registry is a record describing a database of currencies with associated metadata and having the following fields:</p>
<ul>
<li><code>cur-id-&gt;cur</code> – a map of currency ID to currency record;</li>
<li><code>cur-nr-&gt;cur</code> – a map of currency numeric ID to currency record;</li>
<li><code>ctr-id-&gt;cur</code> – a map of country ID to currency record;</li>
<li><code>cur-id-&gt;ctr-ids</code> – a map of currency ID to set of country IDs;</li>
<li><code>cur-id-&gt;localized</code> – a map of currency ID to localized properties map;</li>
<li><code>cur-id-&gt;traits</code> – a map of currency ID to traits (advisory tags);</li>
<li><code>cur-id-&gt;weight</code> – a map of currency ID to weight (integer; conflict resolution);</li>
<li><code>cur-code-&gt;curs</code> – a map of currency code keywords to weighted buckets (sorted sets) of currencies;</li>
<li><code>cur-nr-&gt;curs</code> – a map of currency numeric IDs to weighted buckets (sorted sets) of currencies;</li>
<li><code>cur-dom-&gt;curs</code> – a map of currency domains to weighted buckets (sorted sets) of currencies;</li>
<li><code>hierarchies</code> – a record holding hierarchies for currency classification axes (e.g. <code>:domain</code>, <code>:kind</code>, <code>:traits</code>);</li>
<li><code>version</code> – a string with registry version;</li>
<li><code>ext</code> – a map with extra registry data.</li>
</ul>
<p>Derived index maps (<code>cur-code-&gt;curs</code>, <code>cur-nr-&gt;cur</code>, <code>cur-nr-&gt;curs</code>, <code>cur-dom-&gt;curs</code>, <code>cur-id-&gt;ctr-ids</code>) are built during registry initialization. <code>registry/new-registry</code> accepts base maps; even the arity that accepts a Registry map/record ignores any derived index fields (they are recomputed during initialization).</p>
<h2><a href="#money" id="money"></a>Money</h2>
<p>Money is a record describing a monetary value and having the following fields:</p>
<ul>
<li><code>currency</code> – a Currency object;</li>
<li><code>amount</code> – an amount of currency stored as a <code>BigDecimal</code> number.</li>
</ul>
</div></div></div></body></html>