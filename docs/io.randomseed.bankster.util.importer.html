<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>io.randomseed.bankster.util.importer documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script><link rel="stylesheet" type="text/css" href="css/randomseed.css" /></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Bankster</span> <span class="project-version">2.0.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="10_introduction.html"><div class="inner"><span>Introduction</span></div></a></li><li class="depth-1 "><a href="15_contracts.html"><div class="inner"><span>Bankster Contracts</span></div></a></li><li class="depth-1 "><a href="20_data_structures.html"><div class="inner"><span>Data Structures</span></div></a></li><li class="depth-1 "><a href="30_currency-kinds.html"><div class="inner"><span>Currency kinds</span></div></a></li><li class="depth-1 "><a href="32_currency_traits.html"><div class="inner"><span>Currency traits</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>io</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>randomseed</span></div></div></li><li class="depth-3"><a href="io.randomseed.bankster.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>bankster</span></div></a></li><li class="depth-4 branch"><a href="io.randomseed.bankster.config.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>config</span></div></a></li><li class="depth-4 branch"><a href="io.randomseed.bankster.currency.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>currency</span></div></a></li><li class="depth-4 branch"><a href="io.randomseed.bankster.jsr-354.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>jsr-354</span></div></a></li><li class="depth-4"><a href="io.randomseed.bankster.money.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>money</span></div></a></li><li class="depth-5 branch"><a href="io.randomseed.bankster.money.inter-ops.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>inter-ops</span></div></a></li><li class="depth-5"><a href="io.randomseed.bankster.money.ops.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ops</span></div></a></li><li class="depth-4 branch"><a href="io.randomseed.bankster.registry.html"><div class="inner"><span class="tree" style="top: -83px;"><span class="top" style="height: 92px;"></span><span class="bottom"></span></span><span>registry</span></div></a></li><li class="depth-4 branch"><a href="io.randomseed.bankster.scale.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>scale</span></div></a></li><li class="depth-4"><a href="io.randomseed.bankster.util.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>util</span></div></a></li><li class="depth-5 branch"><a href="io.randomseed.bankster.util.fs.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>fs</span></div></a></li><li class="depth-5 branch current"><a href="io.randomseed.bankster.util.importer.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>importer</span></div></a></li><li class="depth-5"><a href="io.randomseed.bankster.util.map.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>map</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-countries-load"><div class="inner"><span>countries-load</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-currencies-load"><div class="inner"><span>currencies-load</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-currency-.3Emap"><div class="inner"><span>currency-&gt;map</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-default-countries-csv"><div class="inner"><span>default-countries-csv</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-default-currencies-csv"><div class="inner"><span>default-currencies-csv</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-default-data-reader-filename"><div class="inner"><span>default-data-reader-filename</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-default-dump-filename"><div class="inner"><span>default-dump-filename</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-default-export-currency-oriented-filename"><div class="inner"><span>default-export-currency-oriented-filename</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-default-export-filename"><div class="inner"><span>default-export-filename</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-default-handlers-namespace"><div class="inner"><span>default-handlers-namespace</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-default-handlers-pathname"><div class="inner"><span>default-handlers-pathname</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-default-legacy-weight"><div class="inner"><span>default-legacy-weight</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-default-reader-filenames"><div class="inner"><span>default-reader-filenames</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-default-resource-must-exist-file"><div class="inner"><span>default-resource-must-exist-file</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-default-resource-name"><div class="inner"><span>default-resource-name</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-dump"><div class="inner"><span>dump</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-edn-import"><div class="inner"><span>edn-import</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-export"><div class="inner"><span>export</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-export-currency-oriented"><div class="inner"><span>export-currency-oriented</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-handler-gen"><div class="inner"><span>handler-gen</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-import-seed"><div class="inner"><span>import-seed</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-joda-.3Ebankster-dump"><div class="inner"><span>joda-&gt;bankster-dump</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-joda-.3Ebankster-export"><div class="inner"><span>joda-&gt;bankster-export</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-joda-import"><div class="inner"><span>joda-import</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-localized-.3Emap"><div class="inner"><span>localized-&gt;map</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-map-.3Ecurrency-oriented"><div class="inner"><span>map-&gt;currency-oriented</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-merge-registry"><div class="inner"><span>merge-registry</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-readers-export"><div class="inner"><span>readers-export</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-registry-.3Emap"><div class="inner"><span>registry-&gt;map</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-registry-.3Emap-currency-oriented"><div class="inner"><span>registry-&gt;map-currency-oriented</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-seed-import"><div class="inner"><span>seed-import</span></div></a></li><li class="depth-1"><a href="io.randomseed.bankster.util.importer.html#var-traits-.3Emap"><div class="inner"><span>traits-&gt;map</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">io.randomseed.bankster.util.importer</h1><h4 class="added">added in 1.0.0</h4><div class="doc"><div class="markdown"><p>Bankster library, import-export operations.</p>
</div></div><div class="public anchor" id="var-countries-load"><h3>countries-load</h3><h4 class="added">added in 1.0.0</h4><div class="usage"><code>(countries-load)</code><code>(countries-load pathname)</code></div><div class="doc"><div class="markdown"><p>Reads CSV file in a format compliant with Joda Money and returns a map with currency to countries associations where countries are sets. The pathname should be relative to the resources directory.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L143">view source</a></div></div><div class="public anchor" id="var-currencies-load"><h3>currencies-load</h3><h4 class="added">added in 1.0.0</h4><div class="usage"><code>(currencies-load)</code><code>(currencies-load pathname)</code></div><div class="doc"><div class="markdown"><p>Reads a CSV file compliant with Joda Money and returns a sequence of currencies.</p>
<p>The pathname should be relative to the resources directory.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L157">view source</a></div></div><div class="public anchor" id="var-currency-.3Emap"><h3>currency-&gt;map</h3><h4 class="added">added in 1.0.0</h4><div class="usage"><code>(currency-&gt;map {:keys [:numeric :scale :kind], :as c})</code></div><div class="doc"><div class="markdown"><p>Takes a currency and returns a map suitable for putting into a configuration file. Extension fields are ignored.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L206">view source</a></div></div><div class="public anchor" id="var-default-countries-csv"><h3>default-countries-csv</h3><h4 class="added">added in 1.0.0</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Default CSV file with countries database.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L80">view source</a></div></div><div class="public anchor" id="var-default-currencies-csv"><h3>default-currencies-csv</h3><h4 class="added">added in 1.0.0</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Default CSV file with currencies database.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L85">view source</a></div></div><div class="public anchor" id="var-default-data-reader-filename"><h3>default-data-reader-filename</h3><h4 class="added">added in 1.2.4</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Default data reader filename (pure data).</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L65">view source</a></div></div><div class="public anchor" id="var-default-dump-filename"><h3>default-dump-filename</h3><h4 class="added">added in 1.0.0</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Default EDN dump file.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L45">view source</a></div></div><div class="public anchor" id="var-default-export-currency-oriented-filename"><h3>default-export-currency-oriented-filename</h3><h4 class="added">added in 2.0.0</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Default EDN export file (currency-oriented).</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L55">view source</a></div></div><div class="public anchor" id="var-default-export-filename"><h3>default-export-filename</h3><h4 class="added">added in 1.0.0</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Default EDN export file.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L50">view source</a></div></div><div class="public anchor" id="var-default-handlers-namespace"><h3>default-handlers-namespace</h3><h4 class="added">added in 1.0.0</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Default namespace of reader handlers.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L75">view source</a></div></div><div class="public anchor" id="var-default-handlers-pathname"><h3>default-handlers-pathname</h3><h4 class="added">added in 1.0.0</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Default pathname of a reader handlers file.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L70">view source</a></div></div><div class="public anchor" id="var-default-legacy-weight"><h3>default-legacy-weight</h3><h4 class="added">added in 2.0.0</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Default weight of legacy currencies.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L90">view source</a></div></div><div class="public anchor" id="var-default-reader-filenames"><h3>default-reader-filenames</h3><h4 class="added">added in 1.0.0</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Default data reader filenames (Clojure code).</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L60">view source</a></div></div><div class="public anchor" id="var-default-resource-must-exist-file"><h3>default-resource-must-exist-file</h3><h4 class="added">added in 1.0.0</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Filename in a default resource container that must exist.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L34">view source</a></div></div><div class="public anchor" id="var-default-resource-name"><h3>default-resource-name</h3><h4 class="added">added in 1.0.0</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Name of a default resource container.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L29">view source</a></div></div><div class="public anchor" id="var-dump"><h3>dump</h3><h4 class="added">added in 1.0.0</h4><div class="usage"><code>(dump)</code><code>(dump registry)</code><code>(dump filename registry)</code></div><div class="doc"><div class="markdown"><p>For the given filename (defaults to default-dump-filename) and a registry (defaults to a global registry) creates a dump in EDN format.</p>
<p>Filename will be placed in the default directory of resources (the same directory as <code>config.edn</code>).</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L334">view source</a></div></div><div class="public anchor" id="var-edn-import"><h3>edn-import</h3><h4 class="added">added in 2.0.0</h4><div class="usage"><code>(edn-import)</code></div><div class="doc"><div class="markdown"><p>Alias for <code>io.randomseed.bankster.registry/global</code>.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L196">view source</a></div></div><div class="public anchor" id="var-export"><h3>export</h3><h4 class="added">added in 1.0.0</h4><div class="usage"><code>(export)</code><code>(export registry)</code><code>(export filename registry)</code></div><div class="doc"><div class="markdown"><p>For the given filename (defaults to default-export-filename) and a registry (defaults to a global registry) creates a configuration file in EDN format.</p>
<p>Filename will be placed in the default directory of resources (the same directory that holds <code>config.edn</code>).</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L353">view source</a></div></div><div class="public anchor" id="var-export-currency-oriented"><h3>export-currency-oriented</h3><h4 class="added">added in 2.0.0</h4><div class="usage"><code>(export-currency-oriented)</code><code>(export-currency-oriented registry)</code><code>(export-currency-oriented filename registry)</code></div><div class="doc"><div class="markdown"><p>For the given filename (defaults to default-export-currency-oriented-filename) and a registry (defaults to a global registry) creates a currency-oriented configuration file in EDN format.</p>
<p>Currency-oriented export embeds per-currency properties (countries, localized properties and traits) into the maps under <code>:currencies</code>. Top-level branches keep only orphaned entries.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L372">view source</a></div></div><div class="public anchor" id="var-handler-gen"><h3>handler-gen</h3><div class="usage"><code>(handler-gen names)</code></div><div class="doc"><div class="markdown"><p>Generates handler functions for tagged literals for each namespaced currency. Each function will have a prefixed name.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L415">view source</a></div></div><div class="public anchor" id="var-import-seed"><h3>import-seed</h3><h4 class="added">added in 2.0.0</h4><div class="usage"></div><div class="doc"><div class="markdown"><p>Filename in a default resource container which is a static seed for data when importing.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L39">view source</a></div></div><div class="public anchor" id="var-joda-.3Ebankster-dump"><h3>joda-&gt;bankster-dump</h3><h4 class="added">added in 1.0.0</h4><div class="usage"><code>(joda-&gt;bankster-dump)</code></div><div class="doc"><div class="markdown"><p>Reads Joda Money CSV files and creates a registry dump named resources/io/randomseed/bankster/registry-dump.edn.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L819">view source</a></div></div><div class="public anchor" id="var-joda-.3Ebankster-export"><h3>joda-&gt;bankster-export</h3><h4 class="added">added in 1.0.0</h4><div class="usage"><code>(joda-&gt;bankster-export)</code></div><div class="doc"><div class="markdown"><p>Reads Joda Money CSV files and creates a configuration file named resources/io/randomseed/bankster/registry-export.edn.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L828">view source</a></div></div><div class="public anchor" id="var-joda-import"><h3>joda-import</h3><h4 class="added">added in 1.0.0</h4><div class="usage"><code>(joda-import)</code><code>(joda-import countries-pathname currencies-pathname)</code></div><div class="doc"><div class="markdown"><p>Reads CSV files with countries and currencies definitions (Joda Money format) and returns a registry.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L181">view source</a></div></div><div class="public anchor" id="var-localized-.3Emap"><h3>localized-&gt;map</h3><h4 class="added">added in 1.0.0</h4><div class="usage"><code>(localized-&gt;map m)</code></div><div class="doc"><div class="markdown"><p>Takes a localized map entry (1st level) and returns a map suitable for putting into a configuration file.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L216">view source</a></div></div><div class="public anchor" id="var-map-.3Ecurrency-oriented"><h3>map-&gt;currency-oriented</h3><h4 class="added">added in 2.0.0</h4><div class="usage"><code>(map-&gt;currency-oriented m)</code></div><div class="doc"><div class="markdown"><p>Takes a configuration map in a branch-oriented shape (as produced by <code>registry-&gt;map</code>) and returns a currency-oriented variant.</p>
<p>Per-currency properties are embedded into each currency map under <code>:currencies</code>: - <code>:countries</code> (vector of country IDs), - <code>:localized</code> (localized properties map), - <code>:traits</code>    (vector of traits), - <code>:weight</code>    (currency weight).</p>
<p>Top-level branches <code>:countries</code>, <code>:localized</code>, <code>:traits</code> and <code>:weights</code> are reduced to contain only orphaned entries (i.e. those not associated with any known currency IDs).</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L242">view source</a></div></div><div class="public anchor" id="var-merge-registry"><h3>merge-registry</h3><h4 class="added">added in 2.0.0</h4><div class="usage"><code>(merge-registry dst src)</code><code>(merge-registry dst src verbose?)</code><code>(merge-registry dst src verbose? preserve-fields)</code><code>(merge-registry dst src verbose? preserve-fields iso-like?)</code></div><div class="doc"><div class="markdown"><p>Merges two registries by registering currencies from <code>src</code> into <code>dst</code>.</p>
<p>Hierarchies (stored in <code>:hierarchies</code>) and extension data (stored in <code>:ext</code>) are merged as well.</p>
<p>When <code>verbose?</code> is truthy it prints a message for each currency which is present in <code>src</code> but not in <code>dst</code>.</p>
<p>When <code>preserve-fields</code> is given (a sequence of currency record keys, e.g. <code>[:domain :kind]</code>) and a currency is being replaced in <code>dst</code>, the values of these fields are preserved from the original currency in <code>dst</code>.</p>
<p>Special sentinel keywords may be included in <code>preserve-fields</code>:</p>
<ul>
<li><code>::localized</code>  preserve localized properties from <code>dst</code>,</li>
<li><code>::countries</code>  preserve assigned countries from <code>dst</code>.</li>
</ul>
<p>When <code>iso-like?</code> is truthy and the source currency is ISO-like (domain <code>:ISO-4217</code> or <code>:ISO-4217-LEGACY</code>) then the currency identity is treated as its ISO code (name part of the ID). If the source currency is a legacy ISO currency then its destination ID is normalized to <code>:iso-4217-legacy/CODE</code> and it replaces a previously existing <code>:CODE</code> entry (including migration of attached country mappings and localized properties).</p>
<p>Note: in ISO-like mode <code>:domain</code> is never preserved from <code>dst</code> for ISO-like currencies (even if present in <code>preserve-fields</code>), to allow aligning ISO vs legacy ISO classification based on the source.</p>
<p>Legacy currency weight: when a legacy currency has weight 0 and the weight was not explicitly set (presence in <code>:cur-id-&gt;weight</code>) in either source or destination, it is set to <code>default-legacy-weight</code>. Explicit weight 0 is preserved.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L632">view source</a></div></div><div class="public anchor" id="var-readers-export"><h3>readers-export</h3><h4 class="added">added in 1.0.0</h4><div class="usage"><code>(readers-export)</code><code>(readers-export registry)</code><code>(readers-export registry filenames)</code><code>(readers-export registry filenames data-filename)</code><code>(readers-export registry filenames data-filename handlers-pathname handlers-namespace)</code></div><div class="doc"><div class="markdown"><p>Creates clojure source code files with reader functions for tagged literals handling on a basis of registry information and data reader map files referring to the created handlers.</p>
<p>The purpose of generation is primarily to create handlers for literals in forms of #money/NS<a href="…">…</a>, where NS is a namespace that corresponds to a namespace of a currency. Possible namespaces are taken from a registry (a map from its field .cur-id-&gt;cur).</p>
<p>The function takes a registry (defaults to a global registry if not given), a sequence of reader filenames (defaults to default-reader-filenames), default handlers pathname (defaults to default-handlers-pathname) and default handlers namespace (defaults to default-handlers-namespace).</p>
<p>Default namespace is a namespace in which money handlers will be defined. These handlers will be written to a file which pathname is constructed using the following tactic:</p>
<ol>
<li>
<p>Obtain the directory of the first filename from the given filenames list using Java’s resource lookup. The assumption is it should be src directory of a project.</p>
</li>
<li>
<p>Append the file path passed as the handlers-pathname.</p>
</li>
</ol>
<p>As for data reader map files, their directory name is also based on the lookup of the first filename. Each filename will be populated with the same content which is a map associating tagged literal with a function.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L422">view source</a></div></div><div class="public anchor" id="var-registry-.3Emap"><h3>registry-&gt;map</h3><h4 class="added">added in 1.0.0</h4><div class="usage"><code>(registry-&gt;map)</code><code>(registry-&gt;map registry)</code></div><div class="doc"><div class="markdown"><p>Takes a registry and returns a map suitable for putting into a configuration file. Extension fields are ignored. When registry is not given it uses the global one.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L291">view source</a></div></div><div class="public anchor" id="var-registry-.3Emap-currency-oriented"><h3>registry-&gt;map-currency-oriented</h3><h4 class="added">added in 2.0.0</h4><div class="usage"><code>(registry-&gt;map-currency-oriented)</code><code>(registry-&gt;map-currency-oriented registry)</code></div><div class="doc"><div class="markdown"><p>Like <code>registry-&gt;map</code>, but produces a currency-oriented configuration map by embedding per-currency properties (countries, localized properties, traits) into the currency maps. Orphaned top-level entries are kept.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L324">view source</a></div></div><div class="public anchor" id="var-seed-import"><h3>seed-import</h3><h4 class="added">added in 2.0.0</h4><div class="usage"><code>(seed-import)</code><code>(seed-import resource-path)</code></div><div class="doc"><div class="markdown"><p>Loads seed data from an EDN resource file (defaults to <code>seed.edn</code>) and returns a registry.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L526">view source</a></div></div><div class="public anchor" id="var-traits-.3Emap"><h3>traits-&gt;map</h3><h4 class="added">added in 2.0.0</h4><div class="usage"><code>(traits-&gt;map traits)</code></div><div class="doc"><div class="markdown"><p>Takes a traits set/vector and returns a representation suitable for putting into a configuration file.</p>
</div></div><div class="src-link"><a href="https://github.com/randomseed-io/bankster/blob/2.0.0/src/io/randomseed/bankster/util/importer.clj#L223">view source</a></div></div></div></body></html>